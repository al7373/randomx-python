import unittest
from randomx.hashAes1Rx4 import hashAes1Rx4
import os

class TestHashAes1Rx4(unittest.TestCase):
    def test_hashAes1Rx4(self):

        _hash = bytearray(64)

        with open(os.path.join(os.path.dirname(os.path.abspath(__file__)), 'scratchpad_dump.bin'), 'rb') as f:
            scratchpad = f.read()

        # input: bytearray, inputSize: int, hash: bytearray
        hashAes1Rx4(scratchpad, len(scratchpad), _hash)

        expected = bytes([
            0x13,	0x8a,	0xed,	0xa5,	0xf4,	0x70,	0x82,	0xc5,
            0x29,	0x13,	0x09,	0x9f,	0x75,	0xbb,	0x10,	0xce,
            0x2a,	0x5c,	0x7f,	0xa4,	0xd3,	0x1d,	0x1d,	0x37,
            0x7e,	0xf8,	0xa7,	0x40,	0x3d,	0xb5,	0x51,	0x8c,
            0x76,	0x2e,	0x61,	0xfc,	0x59,	0x2a,	0xd4,	0xb1,
            0x2b,	0x5d,	0x72,	0x14,	0x13,	0xd4,	0xdf,	0xc4,
            0xd2,	0x67,	0xfe,	0x13,	0x33,	0xc4,	0x28,	0x47,
            0x03,	0xcf,	0x40,	0x41,	0x92,	0x8a,	0x5e,	0x16
        ])

        self.assertEqual(_hash.hex(), expected.hex())

